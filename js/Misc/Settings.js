import{pageBGColor,headerColor,evenColor,toothpaste,tableBG,modalBGColor,modalFontColor,fontColor}from"./MiscVariables.js";import{changeSound}from"./Sounds.js";const settingsButton=document.getElementById("settingsButton"),settingsPopup=document.getElementById("settingsPopup"),timeInputs=document.querySelectorAll("#customTimeGroup input"),darkModeSwitch=document.getElementById("darkModeSwitch"),workColorPicker=document.getElementById("workColorPicker"),shortColorPicker=document.getElementById("shortColorPicker"),longColorPicker=document.getElementById("longColorPicker"),autoStartSwitch=document.getElementById("autoStartSwitch"),muteSwitch=document.getElementById("muteSwitch"),noDeviceSwitch=document.getElementById("noDeviceSwitch"),workSoundSelector=document.getElementById("workSoundSelector"),breakSoundSelector=document.getElementById("breakSoundSelector"),root=document.querySelector(":root");document.addEventListener("click",(o=>{"block"===settingsPopup.style.display&&(settingsPopup.contains(o.target)||"settingsButton"===o.target.id||"settingsButtonIcon"===o.target.id||(settingsPopup.style.display="none"))})),settingsButton.addEventListener("click",(()=>{"block"===settingsPopup.style.display?settingsPopup.style.display="none":settingsPopup.style.display="block"}));for(let o=0;o<timeInputs.length;o+=1)timeInputs[o].addEventListener("keypress",(o=>{o.which>=48&&o.which<=57||13===o.which||o.preventDefault(),48===o.which&&""===o.target.value&&o.preventDefault()}));const colorShade=(o,e)=>{3===(o=o.replace(/^#/,"")).length&&(o=o[0]+o[0]+o[1]+o[1]+o[2]+o[2]);let[t,r,l]=o.match(/.{2}/g);[t,r,l]=[parseInt(t,16)+e,parseInt(r,16)+e,parseInt(l,16)+e],t=Math.max(Math.min(255,t),0).toString(16),r=Math.max(Math.min(255,r),0).toString(16),l=Math.max(Math.min(255,l),0).toString(16);return`#${(t.length<2?"0":"")+t}${(r.length<2?"0":"")+r}${(l.length<2?"0":"")+l}`};function getFontColor(o){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(o),t=[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)];return.213*t[0]+.715*t[1]+.072*t[2]>200?"black":"white"}function updateDarkMode(){if(darkModeSwitch.checked){document.getElementsByTagName("body")[0].classList.add("dark-mode"),root.style.setProperty(pageBGColor.name,pageBGColor.darkVal),root.style.setProperty(pageBGColor.shortName,pageBGColor.darkVal),root.style.setProperty(pageBGColor.longName,pageBGColor.darkVal),root.style.setProperty(headerColor.name,headerColor.darkVal),root.style.setProperty(headerColor.shortName,headerColor.darkVal),root.style.setProperty(headerColor.longName,headerColor.darkVal),root.style.setProperty(evenColor.name,evenColor.darkVal),root.style.setProperty(evenColor.shortName,evenColor.darkVal),root.style.setProperty(evenColor.longName,evenColor.darkVal),root.style.setProperty(fontColor.name,fontColor.darkVal),root.style.setProperty(fontColor.shortName,fontColor.darkVal),root.style.setProperty(fontColor.longName,fontColor.darkVal),root.style.setProperty(toothpaste.name,toothpaste.darkVal),root.style.setProperty(tableBG.name,tableBG.darkVal),root.style.setProperty(modalBGColor.name,modalBGColor.darkVal),root.style.setProperty(modalFontColor.name,modalFontColor.darkVal),document.getElementById("nav-wrapper").style.backgroundColor="rgb(32, 32, 32)";const o=document.querySelectorAll("#taskListHeader th");for(let e=0;e<o.length;e+=1)o[e].style.backgroundColor="rgb(32, 32, 32)";document.getElementById("add-todo").style.backgroundColor="rgb(32, 32, 32)",document.getElementById("todo").style.backgroundColor="rgb(62, 62, 62)"}else{document.getElementsByTagName("body")[0].classList.remove("dark-mode"),root.style.setProperty(pageBGColor.name,pageBGColor.val),root.style.setProperty(pageBGColor.shortName,pageBGColor.shortVal),root.style.setProperty(pageBGColor.longName,pageBGColor.longVal),root.style.setProperty(headerColor.name,headerColor.val),root.style.setProperty(headerColor.shortName,headerColor.shortVal),root.style.setProperty(headerColor.longName,headerColor.longVal),root.style.setProperty(evenColor.name,evenColor.val),root.style.setProperty(evenColor.shortName,evenColor.shortVal),root.style.setProperty(evenColor.longName,evenColor.longVal),root.style.setProperty(fontColor.name,fontColor.val),root.style.setProperty(fontColor.shortName,fontColor.shortVal),root.style.setProperty(fontColor.longName,fontColor.longVal),root.style.setProperty(toothpaste.name,toothpaste.val),root.style.setProperty(tableBG.name,tableBG.val),root.style.setProperty(modalBGColor.name,modalBGColor.val),root.style.setProperty(modalFontColor.name,modalFontColor.val),document.getElementById("nav-wrapper").style.backgroundColor=null;const o=document.querySelectorAll("#taskListHeader th");for(let e=0;e<o.length;e+=1)o[e].style.backgroundColor=null;document.getElementById("add-todo").style.backgroundColor=null,document.getElementById("todo").style.backgroundColor=null}}null===localStorage.getItem("--page-bg-color")&&(localStorage.setItem("--page-bg-color","#d9645f"),localStorage.setItem("--header-color",colorShade(localStorage.getItem("--page-bg-color"),-60)),localStorage.setItem("--btn-icon-color",colorShade(localStorage.getItem("--page-bg-color"),10)),localStorage.setItem("--font-color",getFontColor(localStorage.getItem("--page-bg-color"))),pageBGColor.val=localStorage.getItem("--page-bg-color"),headerColor.val=localStorage.getItem("--header-color"),evenColor.val=localStorage.getItem("--btn-icon-color"),fontColor.val=localStorage.getItem("--font-color")),root.style.setProperty("--page-bg-color",localStorage.getItem("--page-bg-color")),root.style.setProperty("--header-color",localStorage.getItem("--header-color")),root.style.setProperty("--table-bg-color",colorShade(localStorage.getItem("--page-bg-color"),-10)),root.style.setProperty("--btn-icon-color",colorShade(localStorage.getItem("--page-bg-color"),10)),root.style.setProperty("--btn-icon-hover-color",colorShade(localStorage.getItem("--page-bg-color"),100)),root.style.setProperty("--font-color",localStorage.getItem("--font-color")),workColorPicker.value=localStorage.getItem("--page-bg-color"),null===localStorage.getItem("--page-bg-color-short")&&(localStorage.setItem("--page-bg-color-short","#76a662"),localStorage.setItem("--header-color-short",colorShade(localStorage.getItem("--page-bg-color-short"),-60)),localStorage.setItem("--btn-icon-color-short",colorShade(localStorage.getItem("--page-bg-color-short"),10)),localStorage.setItem("--font-color-short",getFontColor(localStorage.getItem("--page-bg-color-short"))),pageBGColor.shortVal=localStorage.getItem("--page-bg-color-short"),headerColor.shortVal=localStorage.getItem("--header-color-short"),evenColor.shortVal=localStorage.getItem("--btn-icon-color-short"),fontColor.shortVal=localStorage.getItem("--font-color-short")),root.style.setProperty("--page-bg-color-short",localStorage.getItem("--page-bg-color-short")),root.style.setProperty("--header-color-short",localStorage.getItem("--header-color-short")),root.style.setProperty("--table-bg-color-short",colorShade(localStorage.getItem("--page-bg-color-short"),-10)),root.style.setProperty("--btn-icon-color-short",colorShade(localStorage.getItem("--page-bg-color-short"),10)),root.style.setProperty("--btn-icon-hover-color-short",colorShade(localStorage.getItem("--page-bg-color-short"),100)),root.style.setProperty("--font-color-short",localStorage.getItem("--font-color-short")),shortColorPicker.value=localStorage.getItem("--page-bg-color-short"),null===localStorage.getItem("--page-bg-color-long")&&(localStorage.setItem("--page-bg-color-long","#66b4db"),localStorage.setItem("--header-color-long",colorShade(localStorage.getItem("--page-bg-color-long"),-60)),localStorage.setItem("--btn-icon-color-long",colorShade(localStorage.getItem("--page-bg-color-long"),10)),localStorage.setItem("--font-color-long",getFontColor(localStorage.getItem("--page-bg-color-long"))),pageBGColor.longVal=localStorage.getItem("--page-bg-color-long"),headerColor.longVal=localStorage.getItem("--header-color-long"),evenColor.longVal=localStorage.getItem("--btn-icon-color-long"),fontColor.longVal=localStorage.getItem("--font-color-long")),root.style.setProperty("--page-bg-color-long",localStorage.getItem("--page-bg-color-long")),root.style.setProperty("--header-color-long",localStorage.getItem("--header-color-long")),root.style.setProperty("--table-bg-color-long",colorShade(localStorage.getItem("--page-bg-color-long"),-10)),root.style.setProperty("--btn-icon-color-long",colorShade(localStorage.getItem("--page-bg-color-long"),10)),root.style.setProperty("--btn-icon-hover-color-long",colorShade(localStorage.getItem("--page-bg-color-long"),100)),root.style.setProperty("--font-color-long",localStorage.getItem("--font-color-long")),longColorPicker.value=localStorage.getItem("--page-bg-color-long"),darkModeSwitch.addEventListener("change",(()=>{localStorage.setItem("darkModeSwitch",darkModeSwitch.checked),updateDarkMode()})),autoStartSwitch.addEventListener("change",(()=>{localStorage.setItem("autoStartSwitch",autoStartSwitch.checked)})),muteSwitch.addEventListener("change",(()=>{localStorage.setItem("muteSwitch",muteSwitch.checked)})),noDeviceSwitch.addEventListener("change",(()=>{localStorage.setItem("noDeviceSwitch",noDeviceSwitch.checked)})),workColorPicker.addEventListener("change",(()=>{darkModeSwitch.checked||(root.style.setProperty("--page-bg-color",workColorPicker.value),root.style.setProperty("--header-color",colorShade(workColorPicker.value,-60)),root.style.setProperty("--even-color",colorShade(workColorPicker.value,10)),root.style.setProperty("--font-color",getFontColor(workColorPicker.value))),root.style.setProperty("--table-bg-color",colorShade(workColorPicker.value,-10)),root.style.setProperty("--btn-icon-color",colorShade(workColorPicker.value,10)),localStorage.setItem("--page-bg-color",workColorPicker.value),localStorage.setItem("--header-color",colorShade(localStorage.getItem("--page-bg-color"),-60)),localStorage.setItem("--btn-icon-color",colorShade(localStorage.getItem("--page-bg-color"),10)),localStorage.setItem("--font-color",getFontColor(localStorage.getItem("--page-bg-color"))),root.style.setProperty("--btn-icon-hover-color",colorShade(localStorage.getItem("--page-bg-color"),100)),pageBGColor.val=localStorage.getItem("--page-bg-color"),headerColor.val=localStorage.getItem("--header-color"),evenColor.val=localStorage.getItem("--btn-icon-color"),fontColor.val=localStorage.getItem("--font-color")})),shortColorPicker.addEventListener("change",(()=>{darkModeSwitch.checked||(root.style.setProperty("--page-bg-color-short",shortColorPicker.value),root.style.setProperty("--header-color-short",colorShade(shortColorPicker.value,-60)),root.style.setProperty("--even-color-short",colorShade(shortColorPicker.value,10)),root.style.setProperty("--font-color-short",getFontColor(shortColorPicker.value))),root.style.setProperty("--table-bg-color-short",colorShade(shortColorPicker.value,-10)),root.style.setProperty("--btn-icon-color-short",colorShade(shortColorPicker.value,10)),localStorage.setItem("--page-bg-color-short",shortColorPicker.value),localStorage.setItem("--header-color-short",colorShade(localStorage.getItem("--page-bg-color-short"),-60)),localStorage.setItem("--btn-icon-color-short",colorShade(localStorage.getItem("--page-bg-color-short"),10)),localStorage.setItem("--font-color-short",getFontColor(localStorage.getItem("--page-bg-color-short"))),root.style.setProperty("--btn-icon-hover-color-short",colorShade(localStorage.getItem("--page-bg-color-short"),100)),pageBGColor.shortVal=localStorage.getItem("--page-bg-color-short"),headerColor.shortVal=localStorage.getItem("--header-color-short"),evenColor.shortVal=localStorage.getItem("--btn-icon-color-short"),fontColor.shortVal=localStorage.getItem("--font-color-short")})),longColorPicker.addEventListener("change",(()=>{darkModeSwitch.checked||(root.style.setProperty("--page-bg-color-long",longColorPicker.value),root.style.setProperty("--header-color-long",colorShade(longColorPicker.value,-60)),root.style.setProperty("--even-color-long",colorShade(longColorPicker.value,10)),root.style.setProperty("--font-color-long",getFontColor(longColorPicker.value))),root.style.setProperty("--table-bg-color-long",colorShade(longColorPicker.value,-10)),root.style.setProperty("--btn-icon-color-long",colorShade(longColorPicker.value,10)),localStorage.setItem("--page-bg-color-long",longColorPicker.value),localStorage.setItem("--header-color-long",colorShade(localStorage.getItem("--page-bg-color-long"),-60)),localStorage.setItem("--btn-icon-color-long",colorShade(localStorage.getItem("--page-bg-color-long"),10)),localStorage.setItem("--font-color-long",getFontColor(localStorage.getItem("--page-bg-color-long"))),root.style.setProperty("--btn-icon-hover-color-long",colorShade(localStorage.getItem("--page-bg-color-long"),100)),pageBGColor.longVal=localStorage.getItem("--page-bg-color-long"),headerColor.longVal=localStorage.getItem("--header-color-long"),evenColor.longVal=localStorage.getItem("--btn-icon-color-long"),fontColor.longVal=localStorage.getItem("--font-color-long")})),darkModeSwitch.checked=null!=localStorage.getItem("darkModeSwitch")&&"true"===localStorage.getItem("darkModeSwitch"),autoStartSwitch.checked=null==localStorage.getItem("autoStartSwitch")||"true"===localStorage.getItem("autoStartSwitch"),muteSwitch.checked=null!=localStorage.getItem("muteSwitch")&&"true"===localStorage.getItem("muteSwitch"),noDeviceSwitch.checked=null==localStorage.getItem("noDeviceSwitch")||"true"===localStorage.getItem("noDeviceSwitch"),workSoundSelector.value=null==localStorage.getItem("workSoundSelector")?"marimba":localStorage.getItem("workSoundSelector"),breakSoundSelector.value=null==localStorage.getItem("breakSoundSelector")?"marimba":localStorage.getItem("breakSoundSelector"),changeSound(workSoundSelector,!1),changeSound(breakSoundSelector,!1),updateDarkMode();
